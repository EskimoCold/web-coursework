# Установка PostgreSQL на Windows

## Шаг 1: Скачать и установить PostgreSQL

1. **Скачайте установщик:**
   - Перейдите на официальный сайт: https://www.postgresql.org/download/windows/
   - Или используйте прямую ссылку на установщик: https://www.enterprisedb.com/downloads/postgres-postgresql-downloads
   - Выберите последнюю версию PostgreSQL (рекомендуется 16.x или новее)
   - Скачайте установщик для Windows (x86-64)

2. **Запустите установщик:**
   - Запустите скачанный `.exe` файл
   - Следуйте инструкциям мастера установки

3. **Важные настройки при установке:**
   - **Пароль для пользователя postgres:** Задайте пароль (например: `postgres`) - **запомните его!**
   - **Порт:** Оставьте по умолчанию `5432`
   - **Локаль:** Можно оставить по умолчанию
   - **Компоненты:** Убедитесь, что установлены:
     - PostgreSQL Server
     - pgAdmin 4 (графический интерфейс)
     - Command Line Tools

4. **Завершите установку**

## Шаг 2: Проверка установки

После установки PostgreSQL должен автоматически запуститься как служба Windows.

Проверьте, что служба запущена:
- Откройте "Службы" (Services) через поиск Windows
- Найдите "postgresql-x64-16" (или похожее название)
- Убедитесь, что статус "Выполняется" (Running)

## Шаг 3: Создание базы данных

После установки выполните один из вариантов:

### Вариант A: Через командную строку (psql)

1. Откройте командную строку (cmd) или PowerShell
2. Перейдите в папку проекта:
   ```cmd
   cd C:\Users\USER\web-coursework
   ```
3. Запустите скрипт создания базы данных:
   ```cmd
   create_db.bat
   ```

### Вариант B: Через pgAdmin (графический интерфейс)

1. Откройте pgAdmin 4 (из меню Пуск)
2. Подключитесь к серверу (пароль, который вы задали при установке)
3. Правой кнопкой на "Databases" → "Create" → "Database"
4. Имя базы данных: `finance_tracker`
5. Нажмите "Save"

### Вариант C: Вручную через psql

1. Откройте командную строку
2. Выполните:
   ```cmd
   psql -U postgres
   ```
3. Введите пароль, который вы задали при установке
4. Выполните SQL команду:
   ```sql
   CREATE DATABASE finance_tracker;
   ```
5. Выйдите: `\q`

## Шаг 4: Настройка .env файла

Убедитесь, что в файле `backend/.env` указаны правильные параметры:

```env
DATABASE_URL=postgresql+asyncpg://postgres:ВАШ_ПАРОЛЬ@localhost:5432/finance_tracker
SECRET_KEY=your-secret-key-here-change-in-production
DEBUG=true
```

**Важно:** Замените `ВАШ_ПАРОЛЬ` на пароль, который вы задали при установке PostgreSQL.

## Шаг 5: Проверка подключения

Запустите бэкенд:

```cmd
cd backend
venv\Scripts\activate
uvicorn src.main:app --host 0.0.0.0 --port 8000 --reload
```

Если все настроено правильно, вы увидите:
```
✓ Database connection established and tables created
```

## Устранение проблем

### PostgreSQL не запускается
- Откройте "Службы" Windows
- Найдите службу PostgreSQL
- Правой кнопкой → "Запустить" (Start)

### Ошибка подключения
- Проверьте, что PostgreSQL запущен
- Проверьте пароль в `.env` файле
- Проверьте, что порт 5432 не занят другим приложением
- Убедитесь, что база данных `finance_tracker` создана

### Пароль забыт
- Можно сбросить пароль через pgAdmin или изменить в файле `pg_hba.conf`

